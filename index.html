<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Data Pembayaran Buku</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
<link rel="stylesheet" href="style.css">
</head>
<body>
<!-- MODAL SYARAT & KETENTUAN -->
<div id="syaratModal" class="modal fade show" tabindex="-1" style="display: block; background: rgba(0,0,0,0.7);" data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content border-5 border-primary shadow-lg">
      <div class="modal-header bg-gradient text-white" style="background: linear-gradient(90deg, #0d6efd, #6610f2);">
        <h5 class="modal-title"><i class="fa-solid fa-shield-halved me-2"></i>Syarat & Ketentuan Akses Web</h5>
      </div>
      <div class="modal-body" style="max-height: 70vh; overflow-y: auto; font-size: 1.1rem;">
        <p>Selamat datang, Admin! Sebelum melanjutkan, harap baca dan setujui syarat berikut:</p>
        <ul class="list-group list-group-flush">
          <li class="list-group-item list-group-item-warning"><strong>Data siswa wajib ditambahkan terlebih dahulu</strong> sebelum menggunakan web.</li>
          <li class="list-group-item list-group-item-info">Setiap pembayaran buku harus dicatat dengan benar.</li>
          <li class="list-group-item list-group-item-danger">Reset atau hapus data harus dilakukan dengan hati-hati.</li>
          <li class="list-group-item list-group-item-success">Web ini hanya untuk penggunaan internal administrasi sekolah.</li>
          <li class="list-group-item list-group-item-primary"><strong>Setiap selesai mengubah atau menambahkan data, wajib mengekspor data ke file JSON.</strong></li>
          <li class="list-group-item list-group-item-secondary"><strong>Setiap membuka web kembali, wajib mengimpor file JSON sebelum mengakses data.</strong></li>
          <li class="list-group-item list-group-item-info"><strong>Jika berpindah komputer/laptop, wajib mengekspor data dari perangkat lama dan mengimpor ke perangkat baru.</strong></li>
          <li class="list-group-item list-group-item-dark">Pelanggaran syarat ini bisa berakibat pada hilangnya akses atau data.</li>
        </ul>
        <p class="mt-3">Dengan menekan tombol <strong>Setuju & Lanjut</strong>, Anda menyetujui semua syarat di atas.</p>
      </div>
      <div class="modal-footer justify-content-center">
        <button id="btnSetujuSyarat" class="btn btn-gradient w-100" style="background: linear-gradient(90deg,#0dcaf0,#198754); color:white; font-weight:bold; font-size:1.1rem;">
            <i class="fa-solid fa-check me-2"></i>Setuju & Lanjut
        </button>
      </div>
    </div>
  </div>
</div>


<div class="container-fluid mt-4">

    <!-- Header Fixed -->
    <div id="headerFixed" class="bg-white shadow-sm p-3">

        <!-- Tombol dan Pencarian -->
        <div class="row g-2 align-items-center">
<!-- Tombol kiri -->
<div class="col-md-8 col-12 d-flex gap-2 flex-wrap align-items-center">
    <button type="button" class="btn btn-primary" onclick="openTambahModal()">
        <i class="fa-solid fa-plus me-1"></i> Tambah Siswa
    </button>
    
    <button type="button" class="btn btn-success" onclick="importData()">
        <i class="fa-solid fa-file-import me-1"></i> Import
    </button>
    
    <button type="button" class="btn btn-outline-secondary" onclick="exportData()">
        <i class="fa-solid fa-file-export me-1"></i> Export
    </button>
    
    <button type="button" class="btn btn-danger" onclick="hapusSemuaData()">
        <i class="fa-solid fa-trash me-1"></i> Hapus Semua Data
    </button>

        <button type="button" class="btn btn-warning" onclick="resetBayar()">
        <i class="fa-solid fa-rotate-left me-1"></i> Reset Bayar
    </button>
<!-- TOMBOL UPDATE SALDO -->
<button id="btnUpdateSaldo" class="btn btn-info d-flex align-items-center gap-2">
    <i class="fa-solid fa-wallet"></i>
    <span id="btnUpdateSaldoText">UPDATE SALDO</span>
    <span id="btnUpdateSaldoSpinner" class="spinner-border spinner-border-sm d-none" role="status"></span>
    <span id="btnUpdateSaldoNominal" class="ms-2 fw-bold"></span>
</button>

    <!-- SALDO SEKARANG -->
    <div class="ms-3 p-2 bg-info text-white rounded d-flex align-items-center">
    </div>
</div>


            <!-- Pencarian kanan -->
            <div class="col-md-4 col-12">
                <div class="input-group w-100">
                    <span class="input-group-text">
                        <i class="fa-solid fa-magnifying-glass"></i>
                    </span>
                    <input type="text" id="searchInput"
                           class="form-control"
                           placeholder="Cari nama siswa..."
                           oninput="cariSiswa()">
                </div>
            </div>
        </div>
    </div>

    <!-- Pesan tidak ada -->
    <div id="noResult" class="alert alert-warning d-none py-2">
        <i class="fa-solid fa-circle-exclamation"></i> Nama siswa tidak ada
    </div>

    <!-- Tabel data siswa -->
    <div class="card shadow">
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-bordered table-striped align-middle text-center w-100 stretch-table">
                    <thead class="table-primary">
                        <tr>
                            <th>NO</th>
                            <th>NAMA SISWA</th>
                            <th>B.ING</th>
                            <th>B.IND</th>
                            <th>PJOK</th>
                            <th>MTK</th>
                            <th>SENI</th>
                            <th>IPAS</th>
                            <th>BUKU G</th>
                            <th>BUKU H</th>
                            <th>BUKU I</th>
                            <th>TOTAL</th>
                            <th>DIBAYAR</th>
                            <th>SISA</th>
                            <th>STATUS</th>
                            <th>AKSI</th>
                        </tr>
                    </thead>
                    <tbody id="data">
                        <tr>
                            <td>1</td>
                            <td><span class="nama-siswa">Nama Siswa</span></td>

                            <td><input type="checkbox" class="buku"></td>
                            <td><input type="checkbox" class="buku"></td>
                            <td><input type="checkbox" class="buku"></td>
                            <td><input type="checkbox" class="buku"></td>
                            <td><input type="checkbox" class="buku"></td>
                            <td><input type="checkbox" class="buku"></td>
                            <td><input type="checkbox" class="buku"></td>
                            <td><input type="checkbox" class="buku"></td>
                            <td><input type="checkbox" class="buku"></td>

                            <td><input type="text" class="form-control total" readonly></td>
                            <td><input type="number" class="form-control bayar" value="0"></td>
                            <td><input type="text" class="form-control sisa" readonly></td>
                            <td><span class="badge status badge-belum">BELUM LUNAS</span></td>
                            <td class="aksi">
                                <button class="btn btn-warning btn-sm" onclick="openEditModal(this)">
                                    <i class="fa-solid fa-pen-to-square"></i>
                                </button>
                                <button class="btn btn-danger btn-sm" onclick="hapusRow(this)">
                                    <i class="fa-solid fa-trash"></i>
                                </button>
                                <button class="btn btn-success btn-sm" onclick="kirimWA(this)">
                                    <i class="fa-brands fa-whatsapp"></i>
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <div id="pagination" class="my-3 text-center"></div>
            </div>
        </div>
    </div>

</div>

<!-- MODAL EDIT NAMA -->
<div class="modal fade" id="editModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Edit Nama Siswa</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <input type="text" id="editNamaInput" class="form-control" placeholder="Masukkan nama siswa">
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
        <button class="btn btn-primary" onclick="simpanNama()">Simpan</button>
      </div>
    </div>
  </div>
</div>

<!-- MODAL TAMBAH SISWA -->
<div class="modal fade" id="tambahModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Tambah Siswa</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <input type="text" id="tambahNamaInput" class="form-control" placeholder="Nama siswa">
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
        <button class="btn btn-primary" onclick="simpanSiswa()">Simpan</button>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="script.js"></script>